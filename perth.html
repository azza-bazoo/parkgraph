<!DOCTYPE html>
<meta charset="utf-8">
<style>

.roads {
  fill: #fff;
  stroke: #333;
}

</style>
<body>
<script src="http://d3js.org/d3.v3.min.js"></script>
<script src="http://d3js.org/topojson.v1.min.js"></script>
<script type="text/javascript">

var width = 960,
    height = 700;

var svg = d3.select("body").append("svg")
    .attr("width", width)
    .attr("height", height);

var radius = d3.scale.linear()
    .domain([0, 500])
    .range([2, 20]);

var colours = d3.scale.linear()
    .domain([0, 500])
    .range(["#ff0000", "#33e033"]);
// d3.scale.threshold()
//     .domain([.02, .04, .06, .08, .10])
//     .range(["#f2f0f7", "#dadaeb", "#bcbddc", "#9e9ac8", "#756bb1", "#54278f"]);


var projection = d3.geo.mercator()
    .center([115.86, -31.95])
    .scale(1000000);
    // .rotate([4.4, 0])
    // .parallels([50, 60])
    //.translate([width / 2, height / 2]);
var path = d3.geo.path().projection(projection);



d3.json("map/perth.json", function(error, perth) {
  d3.json("data/test.json", function(error, parking) {

    console.log(perth);
    console.log(parking);

    var roads = topojson.feature(perth, perth.objects.roads);
    var waterways = topojson.feature(perth, perth.objects.waterways);

    svg.append("path")
        .attr("class", "roads")
        .datum(roads)
        .attr("d", path);

    svg.selectAll(".symbol")
        .data(parking.features)
//         .data(parking.features.sort(function(a, b) { return b.properties.spaces - a.properties.spaces; }))
      .enter().append("path")
        .attr("class", "symbol")
        .style("fill", function(d) { return colours(d.properties.spaces); })
        .attr("d", path.pointRadius(function(d) { return radius(d.properties.spaces); }));

  });
});


</script>

</body>
</html>

